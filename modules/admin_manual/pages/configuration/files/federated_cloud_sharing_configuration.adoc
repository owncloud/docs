= Configuring Federation Sharing
:toc: right

== Introduction

Federated Cloud Sharing is managed by the Federation app. When you enable the Federation app you can easily and securely link file shares between ownCloud servers, in effect creating a "cloud" of ownCloud installations.

[IMPORTANT]
====
For security reasons federated sharing **strictly requires HTTPS (SSL/TLS)**.
====

== Configuration
Follow these steps to establish a trusted connection between two servers.

. Verify valid SSL certificates on both servers.
. Verify your `overwrite.cli.url` is configured to the correct URL and instead of `localhost`.
. Reset your `oc_jobs` table.
+
----
mysql -u root -e "update oc_jobs set last_run=0;" owncloud;
mysql -u root -e "update oc_jobs set last_checked=0;" owncloud;
----
. Navigate to **admin settings -> sharing -> Federation**
. Add **server 1** to the trusted servers on **server 2**.
. Add **server 2** to the trusted servers on **server 1**.
. Now run the cron job in your ownCloud directory (for example `/var/www/owncloud/`).
+
----
sudo -u www-data php cron.php
----
. Now the check should be green
. Sync now your users with
+
----
occ dav:sync-system-addressbook
occ federation:sync-addressbook
----
. Configure automatic acceptance of new federated shares.
+
----
occ config:app:set federation auto_accept_trusted --value '0'
occ config:app:set federatedfilesharing auto_accept_trusted --value 'yes'
----


[[creating-a-new-federation-share]]
== Creating a new Federation Share

Follow these steps to create a new Federation share between two ownCloud
servers. This requires no action by the user on the remote server;
all it takes is a few steps on the originating server.

.  Enable the Federation app.

. Then, create a federated share by entering username@serveraddress in the sharing dialog (for example `freda@https://example.com/owncloud`). When ownCloud verifies the link,
it displays it with the *(remote)* label. Click on this label to establish the link.
+
image:configuration/files/federation-2.png[image]
. When the link is successfully completed, you have a single share
option, and that is *can edit*.
+
image:configuration/files/federation-3.png[image]
+
You may disconnect the share at any time by clicking the btn:[trash can] icon.